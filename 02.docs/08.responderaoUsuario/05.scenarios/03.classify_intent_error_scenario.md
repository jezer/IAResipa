# Cenário: Tratamento de Erro na Classificação de Intenção

- **Nome do Cenário:** `ClassifyIntent_JsonError`
- **Objetivo:** Verificar se o sistema lida corretamente com uma resposta malformada (JSON inválido) da API do Gemini durante a classificação de intenção.

---

### Pré-condições

- O serviço do Gemini está acessível, mas configurado para retornar uma resposta inválida para este teste.
- O nó `classify_intent` possui tratamento de erro para `json.JSONDecodeError`.

### Ação

1.  O sistema recebe uma `ReservationState` inicial.
2.  O estado é passado para o nó `classify_intent`.
3.  O nó invoca a API do Gemini, que retorna uma string que não é um JSON válido (ex: `"intent": "check_availability"...` com sintaxe incorreta).

### Pós-condições (Resultados Esperados)

1.  A tentativa de fazer o parse do JSON dentro do nó `classify_intent` levanta uma exceção `json.JSONDecodeError`.
2.  O bloco `except` é executado.
3.  O nó atualiza a `ReservationState` com os seguintes valores:
    - `intent`: "general_query"
    - `response`: "Desculpe, não entendi sua solicitação. Pode esclarecer?"

### Teardown (Limpeza)

- Nenhuma ação de limpeza é necessária.
